<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:FuchsControls.Containers"
             xmlns:controls="clr-namespace:FuchsControls"
             x:Class="FuchsControls.Containers.FuchsCard"
             x:Name="Root"
             AutomationProperties.Name="{Binding Title, Source={x:Reference Root}}"
             AutomationProperties.HelpText="{Binding Subtitle, Source={x:Reference Root}}">
    <ContentView.Resources>
        <controls:ListHasItemsConverter x:Key="ListHasItemsConverter" />
        <controls:ObjectIsNotNullConverter x:Key="IsNotNullConverter" />
        <controls:StringIsNotNullOrEmptyConverter x:Key="StringIsNotNull" />
    </ContentView.Resources>

    <!-- Outer border: rounded corners, subtle inner shadow mimic via extra padding, no color changes -->
    <Border x:Name="CardBorder"
            Padding="{Binding Source={x:Reference Root}, Path=Padding}"
            Background="{Binding Background, Source={x:Reference Root}}"
            BackgroundColor="{Binding BackgroundColor, Source={x:Reference Root}}">
        <Border.StrokeShape>
            <RoundRectangle CornerRadius="{Binding CornerRadius, Source={x:Reference Root}}" />
        </Border.StrokeShape>
        <!-- Vertical card structure similar to .card:not(.horizontal) -->
        <Grid RowDefinitions="Auto,Auto,*,Auto,Auto"
              ColumnDefinitions="*"
              RowSpacing="{Binding Spacing, Source={x:Reference Root}}">
            <!-- Image (optional) with consistent aspect and rounded corners -->
            <Border Grid.Row="0"
                    IsVisible="{Binding ImageSource, Source={x:Reference Root}, Converter={StaticResource IsNotNullConverter}}">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="{Binding CornerRadius, Source={x:Reference Root}}" />
                </Border.StrokeShape>
                <Image x:Name="CardImage"
                       Aspect="AspectFill"
                       HeightRequest="160"
                       Source="{Binding ImageSource, Source={x:Reference Root}}" />
            </Border>

            <!-- Header: title + inline actions -->
            <Grid Grid.Row="1"
                  ColumnDefinitions="*,Auto"
                  RowDefinitions="Auto,Auto"
                  ColumnSpacing="8"
                  RowSpacing="4"
                  Padding="4,0,4,0">
                <Label x:Name="TitleLabel"
                       Grid.Row="0"
                       Grid.Column="0"
                       StyleClass="typo-h6"
                       VerticalOptions="Center"
                       IsVisible="{Binding Title, Source={x:Reference Root}, Converter={StaticResource StringIsNotNull}}"
                       Text="{Binding Title, Source={x:Reference Root}, Mode=OneWay}"
                       TextColor="{Binding AccentColor, Source={x:Reference Root}}" />

                <!-- Title actions aligned to the end like header badges -->
                <Grid x:Name="TitleActionGrid"
                      Grid.Row="0"
                      Grid.Column="1"
                      Padding="0"
                      Margin="6,0,0,0"
                      IsVisible="{Binding TitleActionItems, Source={x:Reference Root}, Converter={StaticResource IsNotNullConverter}}" />

                <Label x:Name="SubtitleLabel"
                       Grid.Row="1"
                       Grid.Column="0"
                       Grid.ColumnSpan="2"
                       StyleClass="typo-caption"
                       Opacity="0.8"
                       IsVisible="{Binding Subtitle, Source={x:Reference Root}, Converter={StaticResource StringIsNotNull}}"
                       Text="{Binding Subtitle, Source={x:Reference Root}, Mode=OneWay}" />
            </Grid>

            <!-- Body content with natural growth (hyphenation analogue via line break mode) -->
            <Grid Grid.Row="2" Padding="4,0,4,0" IsVisible="{Binding Body, Source={x:Reference Root}, Converter={StaticResource StringIsNotNull}}">
                <Label x:Name="BodyLabel"
                       Grid.Row="0"
                       Grid.Column="0"
                       StyleClass="typo-body2"
                       LineBreakMode="WordWrap"
                       IsVisible="{Binding Body, Source={x:Reference Root}, Converter={StaticResource StringIsNotNull}}"
                       Text="{Binding Body, Source={x:Reference Root}, Mode=OneWay}" />
            </Grid>

            <!-- Footer area: compact, aligned center -->
            <Grid Grid.Row="3"
                  x:Name="FooterGrid"
                  Padding="0,8,0,0"
                  IsVisible="{Binding FooterItems, Source={x:Reference Root}, Converter={StaticResource IsNotNullConverter}}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
            </Grid>

            <!-- Action area: horizontal button row feel -->
            <Grid Grid.Row="4"
                  x:Name="ActionGrid"
                  Padding="0,6,0,0"
                  IsVisible="{Binding ActionItems, Source={x:Reference Root}, Converter={StaticResource IsNotNullConverter}}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
            </Grid>
        </Grid>
    </Border>
</ContentView>